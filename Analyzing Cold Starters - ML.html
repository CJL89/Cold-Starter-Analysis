{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Importing dependecies:\n",
    "import numpy as np\n",
    "import pandas as pd\n",
    "# from tqdm import tqdm\n",
    "import matplotlib.pyplot as plt\n",
    "import seaborn as sns\n",
    "sns.set(style='darkgrid')\n",
    "import os\n",
    "import warnings\n",
    "warnings.filterwarnings('ignore')\n",
    "\n",
    "# Configuring Notebook environment:\n",
    "sns.set()\n",
    "%matplotlib inline\n",
    "%config InlineBackend.figure_format = 'svg'\n",
    "\n",
    "plt.rcParams['figure.figsize'] = (15, 7.5)\n",
    "pd.set_option('display.max_columns', 100)\n",
    "pd.set_option('display.max_rows', 100)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {},
   "outputs": [],
   "source": [
    "from sklearn.model_selection import train_test_split\n",
    "from sklearn.tree import DecisionTreeClassifier\n",
    "from xgboost import XGBClassifier\n",
    "from sklearn.preprocessing import scale\n",
    "from sklearn.model_selection import RandomizedSearchCV"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# 6.0 Machine Learning Processing:"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## 6.0.1 Pre-processing data"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>product_id</th>\n",
       "      <th>store_id</th>\n",
       "      <th>week_no</th>\n",
       "      <th>display</th>\n",
       "      <th>mailer</th>\n",
       "      <th>household_key</th>\n",
       "      <th>basket_id</th>\n",
       "      <th>day</th>\n",
       "      <th>quantity</th>\n",
       "      <th>sales_value</th>\n",
       "      <th>retail_disc</th>\n",
       "      <th>trans_time</th>\n",
       "      <th>coupon_disc</th>\n",
       "      <th>coupon_match_disc</th>\n",
       "      <th>description</th>\n",
       "      <th>campaign</th>\n",
       "      <th>start_day</th>\n",
       "      <th>end_day</th>\n",
       "      <th>manufacturer</th>\n",
       "      <th>department</th>\n",
       "      <th>brand</th>\n",
       "      <th>commodity_desc</th>\n",
       "      <th>sub_commodity_desc</th>\n",
       "      <th>curr_size_of_product</th>\n",
       "      <th>coupon_upc</th>\n",
       "      <th>age_desc</th>\n",
       "      <th>marital_status_code</th>\n",
       "      <th>income_desc</th>\n",
       "      <th>homeowner_desc</th>\n",
       "      <th>hh_comp_desc</th>\n",
       "      <th>household_size_desc</th>\n",
       "      <th>kid_category_desc</th>\n",
       "      <th>affinity_raw</th>\n",
       "      <th>affinity_rank_pct</th>\n",
       "      <th>affinity_rank_centered</th>\n",
       "      <th>affinity_log</th>\n",
       "      <th>affinity_log_scaled</th>\n",
       "      <th>affinity_rank_buckets</th>\n",
       "      <th>affinity_score</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>818980</td>\n",
       "      <td>367</td>\n",
       "      <td>63</td>\n",
       "      <td>4</td>\n",
       "      <td>0</td>\n",
       "      <td>883</td>\n",
       "      <td>33385517013</td>\n",
       "      <td>434</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.67</td>\n",
       "      <td>-0.22</td>\n",
       "      <td>1252</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>TypeA</td>\n",
       "      <td>26</td>\n",
       "      <td>224</td>\n",
       "      <td>264</td>\n",
       "      <td>1251</td>\n",
       "      <td>GROCERY</td>\n",
       "      <td>National</td>\n",
       "      <td>BEANS - CANNED GLASS &amp; MW</td>\n",
       "      <td>PREPARED BEANS - BAKED W/PORK</td>\n",
       "      <td>15.75 OZ</td>\n",
       "      <td>NaN</td>\n",
       "      <td>35-44</td>\n",
       "      <td>A</td>\n",
       "      <td>35-49K</td>\n",
       "      <td>Homeowner</td>\n",
       "      <td>2 Adults No Kids</td>\n",
       "      <td>2</td>\n",
       "      <td>None/Unknown</td>\n",
       "      <td>0.67</td>\n",
       "      <td>0.048787</td>\n",
       "      <td>-0.907653</td>\n",
       "      <td>-0.400478</td>\n",
       "      <td>0.309007</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>818980</td>\n",
       "      <td>367</td>\n",
       "      <td>63</td>\n",
       "      <td>4</td>\n",
       "      <td>0</td>\n",
       "      <td>883</td>\n",
       "      <td>33385517013</td>\n",
       "      <td>434</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.67</td>\n",
       "      <td>-0.22</td>\n",
       "      <td>1252</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>TypeA</td>\n",
       "      <td>30</td>\n",
       "      <td>323</td>\n",
       "      <td>369</td>\n",
       "      <td>1251</td>\n",
       "      <td>GROCERY</td>\n",
       "      <td>National</td>\n",
       "      <td>BEANS - CANNED GLASS &amp; MW</td>\n",
       "      <td>PREPARED BEANS - BAKED W/PORK</td>\n",
       "      <td>15.75 OZ</td>\n",
       "      <td>NaN</td>\n",
       "      <td>35-44</td>\n",
       "      <td>A</td>\n",
       "      <td>35-49K</td>\n",
       "      <td>Homeowner</td>\n",
       "      <td>2 Adults No Kids</td>\n",
       "      <td>2</td>\n",
       "      <td>None/Unknown</td>\n",
       "      <td>0.67</td>\n",
       "      <td>0.048787</td>\n",
       "      <td>-0.907653</td>\n",
       "      <td>-0.400478</td>\n",
       "      <td>0.309007</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>818980</td>\n",
       "      <td>367</td>\n",
       "      <td>63</td>\n",
       "      <td>4</td>\n",
       "      <td>0</td>\n",
       "      <td>883</td>\n",
       "      <td>33385517013</td>\n",
       "      <td>434</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.67</td>\n",
       "      <td>-0.22</td>\n",
       "      <td>1252</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>TypeA</td>\n",
       "      <td>8</td>\n",
       "      <td>412</td>\n",
       "      <td>460</td>\n",
       "      <td>1251</td>\n",
       "      <td>GROCERY</td>\n",
       "      <td>National</td>\n",
       "      <td>BEANS - CANNED GLASS &amp; MW</td>\n",
       "      <td>PREPARED BEANS - BAKED W/PORK</td>\n",
       "      <td>15.75 OZ</td>\n",
       "      <td>NaN</td>\n",
       "      <td>35-44</td>\n",
       "      <td>A</td>\n",
       "      <td>35-49K</td>\n",
       "      <td>Homeowner</td>\n",
       "      <td>2 Adults No Kids</td>\n",
       "      <td>2</td>\n",
       "      <td>None/Unknown</td>\n",
       "      <td>0.67</td>\n",
       "      <td>0.048787</td>\n",
       "      <td>-0.907653</td>\n",
       "      <td>-0.400478</td>\n",
       "      <td>0.309007</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>818980</td>\n",
       "      <td>367</td>\n",
       "      <td>63</td>\n",
       "      <td>4</td>\n",
       "      <td>0</td>\n",
       "      <td>883</td>\n",
       "      <td>33385517013</td>\n",
       "      <td>434</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.67</td>\n",
       "      <td>-0.22</td>\n",
       "      <td>1252</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>TypeA</td>\n",
       "      <td>13</td>\n",
       "      <td>504</td>\n",
       "      <td>551</td>\n",
       "      <td>1251</td>\n",
       "      <td>GROCERY</td>\n",
       "      <td>National</td>\n",
       "      <td>BEANS - CANNED GLASS &amp; MW</td>\n",
       "      <td>PREPARED BEANS - BAKED W/PORK</td>\n",
       "      <td>15.75 OZ</td>\n",
       "      <td>NaN</td>\n",
       "      <td>35-44</td>\n",
       "      <td>A</td>\n",
       "      <td>35-49K</td>\n",
       "      <td>Homeowner</td>\n",
       "      <td>2 Adults No Kids</td>\n",
       "      <td>2</td>\n",
       "      <td>None/Unknown</td>\n",
       "      <td>0.67</td>\n",
       "      <td>0.048787</td>\n",
       "      <td>-0.907653</td>\n",
       "      <td>-0.400478</td>\n",
       "      <td>0.309007</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>818980</td>\n",
       "      <td>367</td>\n",
       "      <td>63</td>\n",
       "      <td>4</td>\n",
       "      <td>0</td>\n",
       "      <td>883</td>\n",
       "      <td>33385517013</td>\n",
       "      <td>434</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.67</td>\n",
       "      <td>-0.22</td>\n",
       "      <td>1252</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>TypeA</td>\n",
       "      <td>18</td>\n",
       "      <td>587</td>\n",
       "      <td>642</td>\n",
       "      <td>1251</td>\n",
       "      <td>GROCERY</td>\n",
       "      <td>National</td>\n",
       "      <td>BEANS - CANNED GLASS &amp; MW</td>\n",
       "      <td>PREPARED BEANS - BAKED W/PORK</td>\n",
       "      <td>15.75 OZ</td>\n",
       "      <td>NaN</td>\n",
       "      <td>35-44</td>\n",
       "      <td>A</td>\n",
       "      <td>35-49K</td>\n",
       "      <td>Homeowner</td>\n",
       "      <td>2 Adults No Kids</td>\n",
       "      <td>2</td>\n",
       "      <td>None/Unknown</td>\n",
       "      <td>0.67</td>\n",
       "      <td>0.048787</td>\n",
       "      <td>-0.907653</td>\n",
       "      <td>-0.400478</td>\n",
       "      <td>0.309007</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   product_id  store_id  week_no display mailer  household_key    basket_id  \\\n",
       "0      818980       367       63       4      0            883  33385517013   \n",
       "1      818980       367       63       4      0            883  33385517013   \n",
       "2      818980       367       63       4      0            883  33385517013   \n",
       "3      818980       367       63       4      0            883  33385517013   \n",
       "4      818980       367       63       4      0            883  33385517013   \n",
       "\n",
       "   day  quantity  sales_value  retail_disc  trans_time  coupon_disc  \\\n",
       "0  434       1.0         0.67        -0.22        1252            0   \n",
       "1  434       1.0         0.67        -0.22        1252            0   \n",
       "2  434       1.0         0.67        -0.22        1252            0   \n",
       "3  434       1.0         0.67        -0.22        1252            0   \n",
       "4  434       1.0         0.67        -0.22        1252            0   \n",
       "\n",
       "   coupon_match_disc description  campaign  start_day  end_day  manufacturer  \\\n",
       "0                  0       TypeA        26        224      264          1251   \n",
       "1                  0       TypeA        30        323      369          1251   \n",
       "2                  0       TypeA         8        412      460          1251   \n",
       "3                  0       TypeA        13        504      551          1251   \n",
       "4                  0       TypeA        18        587      642          1251   \n",
       "\n",
       "  department     brand             commodity_desc  \\\n",
       "0    GROCERY  National  BEANS - CANNED GLASS & MW   \n",
       "1    GROCERY  National  BEANS - CANNED GLASS & MW   \n",
       "2    GROCERY  National  BEANS - CANNED GLASS & MW   \n",
       "3    GROCERY  National  BEANS - CANNED GLASS & MW   \n",
       "4    GROCERY  National  BEANS - CANNED GLASS & MW   \n",
       "\n",
       "              sub_commodity_desc curr_size_of_product  coupon_upc age_desc  \\\n",
       "0  PREPARED BEANS - BAKED W/PORK             15.75 OZ         NaN    35-44   \n",
       "1  PREPARED BEANS - BAKED W/PORK             15.75 OZ         NaN    35-44   \n",
       "2  PREPARED BEANS - BAKED W/PORK             15.75 OZ         NaN    35-44   \n",
       "3  PREPARED BEANS - BAKED W/PORK             15.75 OZ         NaN    35-44   \n",
       "4  PREPARED BEANS - BAKED W/PORK             15.75 OZ         NaN    35-44   \n",
       "\n",
       "  marital_status_code income_desc homeowner_desc      hh_comp_desc  \\\n",
       "0                   A      35-49K      Homeowner  2 Adults No Kids   \n",
       "1                   A      35-49K      Homeowner  2 Adults No Kids   \n",
       "2                   A      35-49K      Homeowner  2 Adults No Kids   \n",
       "3                   A      35-49K      Homeowner  2 Adults No Kids   \n",
       "4                   A      35-49K      Homeowner  2 Adults No Kids   \n",
       "\n",
       "  household_size_desc kid_category_desc  affinity_raw  affinity_rank_pct  \\\n",
       "0                   2      None/Unknown          0.67           0.048787   \n",
       "1                   2      None/Unknown          0.67           0.048787   \n",
       "2                   2      None/Unknown          0.67           0.048787   \n",
       "3                   2      None/Unknown          0.67           0.048787   \n",
       "4                   2      None/Unknown          0.67           0.048787   \n",
       "\n",
       "   affinity_rank_centered  affinity_log  affinity_log_scaled  \\\n",
       "0               -0.907653     -0.400478             0.309007   \n",
       "1               -0.907653     -0.400478             0.309007   \n",
       "2               -0.907653     -0.400478             0.309007   \n",
       "3               -0.907653     -0.400478             0.309007   \n",
       "4               -0.907653     -0.400478             0.309007   \n",
       "\n",
       "   affinity_rank_buckets  affinity_score  \n",
       "0                      1               1  \n",
       "1                      1               1  \n",
       "2                      1               1  \n",
       "3                      1               1  \n",
       "4                      1               1  "
      ]
     },
     "execution_count": 3,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df_clean = pd.read_csv('df_clean.csv')\n",
    "df_clean.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "<class 'pandas.core.frame.DataFrame'>\n",
      "RangeIndex: 2993709 entries, 0 to 2993708\n",
      "Data columns (total 39 columns):\n",
      "product_id                int64\n",
      "store_id                  int64\n",
      "week_no                   int64\n",
      "display                   object\n",
      "mailer                    object\n",
      "household_key             int64\n",
      "basket_id                 int64\n",
      "day                       int64\n",
      "quantity                  float64\n",
      "sales_value               float64\n",
      "retail_disc               float64\n",
      "trans_time                int64\n",
      "coupon_disc               int64\n",
      "coupon_match_disc         int64\n",
      "description               object\n",
      "campaign                  int64\n",
      "start_day                 int64\n",
      "end_day                   int64\n",
      "manufacturer              int64\n",
      "department                object\n",
      "brand                     object\n",
      "commodity_desc            object\n",
      "sub_commodity_desc        object\n",
      "curr_size_of_product      object\n",
      "coupon_upc                float64\n",
      "age_desc                  object\n",
      "marital_status_code       object\n",
      "income_desc               object\n",
      "homeowner_desc            object\n",
      "hh_comp_desc              object\n",
      "household_size_desc       object\n",
      "kid_category_desc         object\n",
      "affinity_raw              float64\n",
      "affinity_rank_pct         float64\n",
      "affinity_rank_centered    float64\n",
      "affinity_log              float64\n",
      "affinity_log_scaled       float64\n",
      "affinity_rank_buckets     int64\n",
      "affinity_score            int64\n",
      "dtypes: float64(9), int64(15), object(15)\n",
      "memory usage: 890.8+ MB\n"
     ]
    }
   ],
   "source": [
    "df_clean.info()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>product_id</th>\n",
       "      <th>store_id</th>\n",
       "      <th>sales_value</th>\n",
       "      <th>manufacturer</th>\n",
       "      <th>display_0</th>\n",
       "      <th>display_0</th>\n",
       "      <th>display_1</th>\n",
       "      <th>display_2</th>\n",
       "      <th>display_3</th>\n",
       "      <th>display_4</th>\n",
       "      <th>display_5</th>\n",
       "      <th>display_6</th>\n",
       "      <th>display_7</th>\n",
       "      <th>display_9</th>\n",
       "      <th>display_A</th>\n",
       "      <th>mailer_0</th>\n",
       "      <th>mailer_A</th>\n",
       "      <th>mailer_C</th>\n",
       "      <th>mailer_D</th>\n",
       "      <th>mailer_F</th>\n",
       "      <th>mailer_H</th>\n",
       "      <th>mailer_J</th>\n",
       "      <th>mailer_L</th>\n",
       "      <th>mailer_X</th>\n",
       "      <th>mailer_Z</th>\n",
       "      <th>description_TypeA</th>\n",
       "      <th>description_TypeB</th>\n",
       "      <th>description_TypeC</th>\n",
       "      <th>department_CHARITABLE CONT</th>\n",
       "      <th>department_CHEF SHOPPE</th>\n",
       "      <th>department_COSMETICS</th>\n",
       "      <th>department_COUP/STR &amp; MFG</th>\n",
       "      <th>department_DAIRY DELI</th>\n",
       "      <th>department_DELI</th>\n",
       "      <th>department_DRUG GM</th>\n",
       "      <th>department_FLORAL</th>\n",
       "      <th>department_GARDEN CENTER</th>\n",
       "      <th>department_GROCERY</th>\n",
       "      <th>department_HBC</th>\n",
       "      <th>department_MEAT</th>\n",
       "      <th>department_MEAT-PCKGD</th>\n",
       "      <th>department_MISC SALES TRAN</th>\n",
       "      <th>department_MISC. TRANS.</th>\n",
       "      <th>department_NUTRITION</th>\n",
       "      <th>department_PASTRY</th>\n",
       "      <th>department_PHARMACY SUPPLY</th>\n",
       "      <th>department_PHOTO</th>\n",
       "      <th>department_POSTAL CENTER</th>\n",
       "      <th>department_PRODUCE</th>\n",
       "      <th>department_RX</th>\n",
       "      <th>department_SALAD BAR</th>\n",
       "      <th>department_SEAFOOD</th>\n",
       "      <th>department_SEAFOOD-PCKGD</th>\n",
       "      <th>department_SPIRITS</th>\n",
       "      <th>department_TRAVEL &amp; LEISUR</th>\n",
       "      <th>brand_National</th>\n",
       "      <th>brand_Private</th>\n",
       "      <th>income_desc_100-124K</th>\n",
       "      <th>income_desc_125-149K</th>\n",
       "      <th>income_desc_15-24K</th>\n",
       "      <th>income_desc_150-174K</th>\n",
       "      <th>income_desc_175-199K</th>\n",
       "      <th>income_desc_200-249K</th>\n",
       "      <th>income_desc_25-34K</th>\n",
       "      <th>income_desc_250K+</th>\n",
       "      <th>income_desc_35-49K</th>\n",
       "      <th>income_desc_50-74K</th>\n",
       "      <th>income_desc_75-99K</th>\n",
       "      <th>income_desc_Under 15K</th>\n",
       "      <th>homeowner_desc_Homeowner</th>\n",
       "      <th>homeowner_desc_Probable Owner</th>\n",
       "      <th>homeowner_desc_Probable Renter</th>\n",
       "      <th>homeowner_desc_Renter</th>\n",
       "      <th>homeowner_desc_Unknown</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>818980</td>\n",
       "      <td>367</td>\n",
       "      <td>0.67</td>\n",
       "      <td>1251</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>818980</td>\n",
       "      <td>367</td>\n",
       "      <td>0.67</td>\n",
       "      <td>1251</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>818980</td>\n",
       "      <td>367</td>\n",
       "      <td>0.67</td>\n",
       "      <td>1251</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>818980</td>\n",
       "      <td>367</td>\n",
       "      <td>0.67</td>\n",
       "      <td>1251</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>818980</td>\n",
       "      <td>367</td>\n",
       "      <td>0.67</td>\n",
       "      <td>1251</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   product_id  store_id  sales_value  manufacturer  display_0  display_0  \\\n",
       "0      818980       367         0.67          1251          0          0   \n",
       "1      818980       367         0.67          1251          0          0   \n",
       "2      818980       367         0.67          1251          0          0   \n",
       "3      818980       367         0.67          1251          0          0   \n",
       "4      818980       367         0.67          1251          0          0   \n",
       "\n",
       "   display_1  display_2  display_3  display_4  display_5  display_6  \\\n",
       "0          0          0          0          1          0          0   \n",
       "1          0          0          0          1          0          0   \n",
       "2          0          0          0          1          0          0   \n",
       "3          0          0          0          1          0          0   \n",
       "4          0          0          0          1          0          0   \n",
       "\n",
       "   display_7  display_9  display_A  mailer_0  mailer_A  mailer_C  mailer_D  \\\n",
       "0          0          0          0         1         0         0         0   \n",
       "1          0          0          0         1         0         0         0   \n",
       "2          0          0          0         1         0         0         0   \n",
       "3          0          0          0         1         0         0         0   \n",
       "4          0          0          0         1         0         0         0   \n",
       "\n",
       "   mailer_F  mailer_H  mailer_J  mailer_L  mailer_X  mailer_Z  \\\n",
       "0         0         0         0         0         0         0   \n",
       "1         0         0         0         0         0         0   \n",
       "2         0         0         0         0         0         0   \n",
       "3         0         0         0         0         0         0   \n",
       "4         0         0         0         0         0         0   \n",
       "\n",
       "   description_TypeA  description_TypeB  description_TypeC  \\\n",
       "0                  1                  0                  0   \n",
       "1                  1                  0                  0   \n",
       "2                  1                  0                  0   \n",
       "3                  1                  0                  0   \n",
       "4                  1                  0                  0   \n",
       "\n",
       "   department_CHARITABLE CONT  department_CHEF SHOPPE  department_COSMETICS  \\\n",
       "0                           0                       0                     0   \n",
       "1                           0                       0                     0   \n",
       "2                           0                       0                     0   \n",
       "3                           0                       0                     0   \n",
       "4                           0                       0                     0   \n",
       "\n",
       "   department_COUP/STR & MFG  department_DAIRY DELI  department_DELI  \\\n",
       "0                          0                      0                0   \n",
       "1                          0                      0                0   \n",
       "2                          0                      0                0   \n",
       "3                          0                      0                0   \n",
       "4                          0                      0                0   \n",
       "\n",
       "   department_DRUG GM  department_FLORAL  department_GARDEN CENTER  \\\n",
       "0                   0                  0                         0   \n",
       "1                   0                  0                         0   \n",
       "2                   0                  0                         0   \n",
       "3                   0                  0                         0   \n",
       "4                   0                  0                         0   \n",
       "\n",
       "   department_GROCERY  department_HBC  department_MEAT  department_MEAT-PCKGD  \\\n",
       "0                   1               0                0                      0   \n",
       "1                   1               0                0                      0   \n",
       "2                   1               0                0                      0   \n",
       "3                   1               0                0                      0   \n",
       "4                   1               0                0                      0   \n",
       "\n",
       "   department_MISC SALES TRAN  department_MISC. TRANS.  department_NUTRITION  \\\n",
       "0                           0                        0                     0   \n",
       "1                           0                        0                     0   \n",
       "2                           0                        0                     0   \n",
       "3                           0                        0                     0   \n",
       "4                           0                        0                     0   \n",
       "\n",
       "   department_PASTRY  department_PHARMACY SUPPLY  department_PHOTO  \\\n",
       "0                  0                           0                 0   \n",
       "1                  0                           0                 0   \n",
       "2                  0                           0                 0   \n",
       "3                  0                           0                 0   \n",
       "4                  0                           0                 0   \n",
       "\n",
       "   department_POSTAL CENTER  department_PRODUCE  department_RX  \\\n",
       "0                         0                   0              0   \n",
       "1                         0                   0              0   \n",
       "2                         0                   0              0   \n",
       "3                         0                   0              0   \n",
       "4                         0                   0              0   \n",
       "\n",
       "   department_SALAD BAR  department_SEAFOOD  department_SEAFOOD-PCKGD  \\\n",
       "0                     0                   0                         0   \n",
       "1                     0                   0                         0   \n",
       "2                     0                   0                         0   \n",
       "3                     0                   0                         0   \n",
       "4                     0                   0                         0   \n",
       "\n",
       "   department_SPIRITS  department_TRAVEL & LEISUR  brand_National  \\\n",
       "0                   0                           0               1   \n",
       "1                   0                           0               1   \n",
       "2                   0                           0               1   \n",
       "3                   0                           0               1   \n",
       "4                   0                           0               1   \n",
       "\n",
       "   brand_Private  income_desc_100-124K  income_desc_125-149K  \\\n",
       "0              0                     0                     0   \n",
       "1              0                     0                     0   \n",
       "2              0                     0                     0   \n",
       "3              0                     0                     0   \n",
       "4              0                     0                     0   \n",
       "\n",
       "   income_desc_15-24K  income_desc_150-174K  income_desc_175-199K  \\\n",
       "0                   0                     0                     0   \n",
       "1                   0                     0                     0   \n",
       "2                   0                     0                     0   \n",
       "3                   0                     0                     0   \n",
       "4                   0                     0                     0   \n",
       "\n",
       "   income_desc_200-249K  income_desc_25-34K  income_desc_250K+  \\\n",
       "0                     0                   0                  0   \n",
       "1                     0                   0                  0   \n",
       "2                     0                   0                  0   \n",
       "3                     0                   0                  0   \n",
       "4                     0                   0                  0   \n",
       "\n",
       "   income_desc_35-49K  income_desc_50-74K  income_desc_75-99K  \\\n",
       "0                   1                   0                   0   \n",
       "1                   1                   0                   0   \n",
       "2                   1                   0                   0   \n",
       "3                   1                   0                   0   \n",
       "4                   1                   0                   0   \n",
       "\n",
       "   income_desc_Under 15K  homeowner_desc_Homeowner  \\\n",
       "0                      0                         1   \n",
       "1                      0                         1   \n",
       "2                      0                         1   \n",
       "3                      0                         1   \n",
       "4                      0                         1   \n",
       "\n",
       "   homeowner_desc_Probable Owner  homeowner_desc_Probable Renter  \\\n",
       "0                              0                               0   \n",
       "1                              0                               0   \n",
       "2                              0                               0   \n",
       "3                              0                               0   \n",
       "4                              0                               0   \n",
       "\n",
       "   homeowner_desc_Renter  homeowner_desc_Unknown  \n",
       "0                      0                       0  \n",
       "1                      0                       0  \n",
       "2                      0                       0  \n",
       "3                      0                       0  \n",
       "4                      0                       0  "
      ]
     },
     "execution_count": 5,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Narrowing the columns for faster output:\n",
    "df_training = df_clean[['product_id', 'store_id', 'display', 'mailer', 'sales_value', 'description', 'manufacturer','department', 'brand', 'income_desc', 'homeowner_desc']]\n",
    "# df_training = df_clean[['sales_value', 'product_id', 'store_id', 'week_no', 'retail_disc', 'age_desc', 'marital_status_code', 'income_desc']]\n",
    "df_training = pd.get_dummies(df_training)\n",
    "df_training.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "<class 'pandas.core.frame.DataFrame'>\n",
      "RangeIndex: 2993709 entries, 0 to 2993708\n",
      "Data columns (total 74 columns):\n",
      "product_id                        int64\n",
      "store_id                          int64\n",
      "sales_value                       float64\n",
      "manufacturer                      int64\n",
      "display_0                         uint8\n",
      "display_0                         uint8\n",
      "display_1                         uint8\n",
      "display_2                         uint8\n",
      "display_3                         uint8\n",
      "display_4                         uint8\n",
      "display_5                         uint8\n",
      "display_6                         uint8\n",
      "display_7                         uint8\n",
      "display_9                         uint8\n",
      "display_A                         uint8\n",
      "mailer_0                          uint8\n",
      "mailer_A                          uint8\n",
      "mailer_C                          uint8\n",
      "mailer_D                          uint8\n",
      "mailer_F                          uint8\n",
      "mailer_H                          uint8\n",
      "mailer_J                          uint8\n",
      "mailer_L                          uint8\n",
      "mailer_X                          uint8\n",
      "mailer_Z                          uint8\n",
      "description_TypeA                 uint8\n",
      "description_TypeB                 uint8\n",
      "description_TypeC                 uint8\n",
      "department_CHARITABLE CONT        uint8\n",
      "department_CHEF SHOPPE            uint8\n",
      "department_COSMETICS              uint8\n",
      "department_COUP/STR & MFG         uint8\n",
      "department_DAIRY DELI             uint8\n",
      "department_DELI                   uint8\n",
      "department_DRUG GM                uint8\n",
      "department_FLORAL                 uint8\n",
      "department_GARDEN CENTER          uint8\n",
      "department_GROCERY                uint8\n",
      "department_HBC                    uint8\n",
      "department_MEAT                   uint8\n",
      "department_MEAT-PCKGD             uint8\n",
      "department_MISC SALES TRAN        uint8\n",
      "department_MISC. TRANS.           uint8\n",
      "department_NUTRITION              uint8\n",
      "department_PASTRY                 uint8\n",
      "department_PHARMACY SUPPLY        uint8\n",
      "department_PHOTO                  uint8\n",
      "department_POSTAL CENTER          uint8\n",
      "department_PRODUCE                uint8\n",
      "department_RX                     uint8\n",
      "department_SALAD BAR              uint8\n",
      "department_SEAFOOD                uint8\n",
      "department_SEAFOOD-PCKGD          uint8\n",
      "department_SPIRITS                uint8\n",
      "department_TRAVEL & LEISUR        uint8\n",
      "brand_National                    uint8\n",
      "brand_Private                     uint8\n",
      "income_desc_100-124K              uint8\n",
      "income_desc_125-149K              uint8\n",
      "income_desc_15-24K                uint8\n",
      "income_desc_150-174K              uint8\n",
      "income_desc_175-199K              uint8\n",
      "income_desc_200-249K              uint8\n",
      "income_desc_25-34K                uint8\n",
      "income_desc_250K+                 uint8\n",
      "income_desc_35-49K                uint8\n",
      "income_desc_50-74K                uint8\n",
      "income_desc_75-99K                uint8\n",
      "income_desc_Under 15K             uint8\n",
      "homeowner_desc_Homeowner          uint8\n",
      "homeowner_desc_Probable Owner     uint8\n",
      "homeowner_desc_Probable Renter    uint8\n",
      "homeowner_desc_Renter             uint8\n",
      "homeowner_desc_Unknown            uint8\n",
      "dtypes: float64(1), int64(3), uint8(70)\n",
      "memory usage: 291.2 MB\n"
     ]
    }
   ],
   "source": [
    "df_training.info()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## 6.0.2 Model formula:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "metadata": {},
   "outputs": [],
   "source": [
    "def train_test_model(X, y, model, params, test_size=.2, random_state=42):\n",
    "    \n",
    "    X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=test_size, random_state=random_state)\n",
    "    \n",
    "    model_cv = GridSearchCV(model, param_grid=params, cv=5)\n",
    "    \n",
    "    model_cv.fit(X_train, y_train)\n",
    "    \n",
    "    y_pred = model_cv.predict(X_test)\n",
    "    \n",
    "    y_pred_prob = model_cv.predict_proba(X_test)[:,1]\n",
    "    \n",
    "    fpr, tpr, thresholds = roc_curve(y_test, y_pred_prob)\n",
    "\n",
    "    # Plot ROC curve\n",
    "    plt.plot([0, 1], [0, 1], 'k--')\n",
    "    plt.plot(fpr, tpr, label='ROC curve (area = %0.2f)' % auc(fpr,tpr))\n",
    "    plt.xlabel('False Positive Rate')\n",
    "    plt.ylabel('True Positive Rate')\n",
    "    plt.xlim([0.0, 1.0])\n",
    "    plt.ylim([0.0, 1.05])\n",
    "    plt.title('ROC Curve')\n",
    "    plt.legend(loc=\"lower right\")\n",
    "    plt.show();\n",
    "    \n",
    "    # Print the optimal parameters and best score\n",
    "    print(\"Tuned Hyperparameter(s): {}\".format(model_cv.best_params_))\n",
    "    print(\"Tuned Accuracy Score: {}\".format(model_cv.best_score_))\n",
    "    print(classification_report(y_test, y_pred))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 39,
   "metadata": {},
   "outputs": [],
   "source": [
    "# # X_train, X_test, y_train, y_test = []\n",
    "\n",
    "# def simple_train_test_model(X, y, model, test_size=.25, random_state=42, shuffle=True):\n",
    "#     X_train, X_test, y_train, y_test = train_test_split(X, y, train_size=0.75, test_size=0.25, random_state=42, shuffle=True)\n",
    "#     clf = model\n",
    "#     clf.fit(X_train, y_train)\n",
    "#     print(clf.score(X_test, y_test))"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## 6.0.3 Creating/Splitting the data:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "dtype('int64')"
      ]
     },
     "execution_count": 12,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df_training['sales_value'] = df_training['sales_value'].astype(int)\n",
    "df_training['sales_value'].dtypes"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "(2993709, 73) (2993709,)\n"
     ]
    }
   ],
   "source": [
    "# Calculating a simple linear regression, even though it is not the most effective way to train the dataset on:\n",
    "X = df_training.drop(['sales_value'], axis=1).values\n",
    "y = df_training['sales_value'].values\n",
    "print(X.shape, y.shape)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## 6.1.0 Linear Models:"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### 6.1.1 Linear Regression - To predict product prices"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "metadata": {},
   "outputs": [],
   "source": [
    "from sklearn.linear_model import LinearRegression"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 40,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "0.14532781368631498\n"
     ]
    }
   ],
   "source": [
    "simple_train_test_model(X, y, LinearRegression())\n",
    "X_train, X_test, y_train, y_test = train_test_split(X, y, train_size=0.75, test_size=0.25, random_state=42, shuffle=True)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 41,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "2993709\n",
      "0.7499997494746483\n",
      "0.2500002505253517\n"
     ]
    }
   ],
   "source": [
    "print(X.shape[0])\n",
    "print(float(X_train.shape[0]) / float(X.shape[0]))\n",
    "print(float(X_test.shape[0]) / float(X.shape[0]))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 42,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0.14532781368631498"
      ]
     },
     "execution_count": 42,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "model = LinearRegression()\n",
    "model.fit(X_train, y_train)\n",
    "model.score(X_test, y_test)\n",
    "# preds = model.predict(X_train)\n",
    "# print('Train accuracy score:',accuracy_score(y_train, preds))\n",
    "# print('Test accuracy score:', accuracy_score(y_test,logreg.predict(X_test))) "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 43,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Model: 1.628714240841365, Actual: 0, Percentile: inf%\n",
      "Model: 1.507951083890021, Actual: 2, Percentile: 75.4%\n",
      "Model: 2.4750104909766026, Actual: 4, Percentile: 61.88%\n",
      "Model: 1.5173715768161449, Actual: 3, Percentile: 50.58%\n",
      "Model: 2.3888579941119388, Actual: 1, Percentile: 238.89%\n",
      "Model: 1.8660639796385996, Actual: 0, Percentile: inf%\n",
      "Model: 1.793460662012857, Actual: 2, Percentile: 89.67%\n",
      "Model: 3.904200973320652, Actual: 3, Percentile: 130.14%\n",
      "Model: 2.581768589511562, Actual: 3, Percentile: 86.06%\n",
      "Model: 2.7408457960185246, Actual: 2, Percentile: 137.04%\n",
      "Model: 2.3418925401000954, Actual: 2, Percentile: 117.09%\n",
      "Model: 2.3527203679798094, Actual: 1, Percentile: 235.27%\n",
      "Model: 1.5930390049563448, Actual: 0, Percentile: inf%\n",
      "Model: 2.508986521527837, Actual: 2, Percentile: 125.45%\n",
      "Model: 2.4461211695032614, Actual: 1, Percentile: 244.61%\n",
      "Model: 5.711722933688051, Actual: 6, Percentile: 95.2%\n",
      "Model: 2.6489299605323104, Actual: 2, Percentile: 132.45%\n",
      "Model: 2.0114789815071354, Actual: 0, Percentile: inf%\n",
      "Model: 1.521938718920571, Actual: 0, Percentile: inf%\n",
      "Model: 2.4216050725148897, Actual: 2, Percentile: 121.08%\n",
      "Model: 0.9160338555024352, Actual: 1, Percentile: 91.6%\n",
      "Model: 1.7014093552977925, Actual: 2, Percentile: 85.07%\n",
      "Model: 2.5331918415760315, Actual: 1, Percentile: 253.32%\n",
      "Model: 1.740948365771069, Actual: 0, Percentile: inf%\n",
      "Model: 6.253144089873551, Actual: 20, Percentile: 31.27%\n",
      "Model: 5.8661836097922695, Actual: 13, Percentile: 45.12%\n",
      "Model: 2.6539850414331716, Actual: 5, Percentile: 53.08%\n",
      "Model: 1.1630315947083867, Actual: 0, Percentile: inf%\n",
      "Model: 2.3383353192324177, Actual: 2, Percentile: 116.92%\n",
      "Model: 2.298211058960077, Actual: 1, Percentile: 229.82%\n",
      "Model: 2.4996788330612345, Actual: 4, Percentile: 62.49%\n",
      "Model: 2.0756763746054783, Actual: 1, Percentile: 207.57%\n",
      "Model: 2.8630381756485903, Actual: 8, Percentile: 35.79%\n",
      "Model: 1.686799989504971, Actual: 1, Percentile: 168.68%\n",
      "Model: 3.4580444935435546, Actual: 2, Percentile: 172.9%\n",
      "Model: 1.8386882352190037, Actual: 1, Percentile: 183.87%\n",
      "Model: 1.9977837168523167, Actual: 1, Percentile: 199.78%\n",
      "Model: 3.2942721487125635, Actual: 1, Percentile: 329.43%\n",
      "Model: 2.3647454721961085, Actual: 2, Percentile: 118.24%\n",
      "Model: 2.5364277820099135, Actual: 1, Percentile: 253.64%\n",
      "Model: 5.726577550748834, Actual: 4, Percentile: 143.16%\n",
      "Model: 1.833148197565503, Actual: 3, Percentile: 61.1%\n",
      "Model: 2.0124223966423473, Actual: 1, Percentile: 201.24%\n",
      "Model: 1.7546785342656994, Actual: 4, Percentile: 43.87%\n",
      "Model: 1.6911947385585382, Actual: 1, Percentile: 169.12%\n",
      "Model: 2.0754679644146434, Actual: 1, Percentile: 207.55%\n",
      "Model: 0.9136128670931534, Actual: 1, Percentile: 91.36%\n",
      "Model: 6.566607697975842, Actual: 6, Percentile: 109.44%\n",
      "Model: 6.538920445442474, Actual: 6, Percentile: 108.98%\n",
      "Model: 2.1354601350335485, Actual: 4, Percentile: 53.39%\n"
     ]
    }
   ],
   "source": [
    "for X, y in zip(X_test[:50], y_test[:50]):\n",
    "    print(f\"Model: {model.predict([X])[0]}, Actual: {y}, Percentile: {round((model.predict([X])[0]/y)*100.00, 2)}%\")"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## 6.2 Classification"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### 6.2.1 Random Forest Classifier"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 44,
   "metadata": {},
   "outputs": [],
   "source": [
    "from sklearn.ensemble import RandomForestClassifier"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 49,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0.3542558536024841"
      ]
     },
     "execution_count": 49,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "rfc_b = RandomForestClassifier(max_depth=2, random_state=0, n_estimators=100)\n",
    "rfc_b.fit(X_train, y_train)\n",
    "y_pred = rfc_b.predict(X_train)\n",
    "rfc_b.score(X_test, y_test)\n",
    "# print('Train accuracy score:',accuracy_score(y_train,y_pred))\n",
    "# print('Test accuracy score:', accuracy_score(y_test,rfc_b.predict(X_test)))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 54,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Model: 1, Actual: 0, Percentile: inf%\n",
      "Model: 1, Actual: 2, Percentile: 50.0%\n",
      "Model: 1, Actual: 4, Percentile: 25.0%\n",
      "Model: 1, Actual: 3, Percentile: 33.33%\n",
      "Model: 1, Actual: 1, Percentile: 100.0%\n",
      "Model: 1, Actual: 0, Percentile: inf%\n",
      "Model: 1, Actual: 2, Percentile: 50.0%\n",
      "Model: 2, Actual: 3, Percentile: 66.67%\n",
      "Model: 1, Actual: 3, Percentile: 33.33%\n",
      "Model: 1, Actual: 2, Percentile: 50.0%\n",
      "Model: 1, Actual: 2, Percentile: 50.0%\n",
      "Model: 1, Actual: 1, Percentile: 100.0%\n",
      "Model: 1, Actual: 0, Percentile: inf%\n",
      "Model: 2, Actual: 2, Percentile: 100.0%\n",
      "Model: 1, Actual: 1, Percentile: 100.0%\n",
      "Model: 2, Actual: 6, Percentile: 33.33%\n",
      "Model: 1, Actual: 2, Percentile: 50.0%\n",
      "Model: 1, Actual: 0, Percentile: inf%\n",
      "Model: 1, Actual: 0, Percentile: inf%\n",
      "Model: 1, Actual: 2, Percentile: 50.0%\n",
      "Model: 1, Actual: 1, Percentile: 100.0%\n",
      "Model: 1, Actual: 2, Percentile: 50.0%\n",
      "Model: 1, Actual: 1, Percentile: 100.0%\n",
      "Model: 1, Actual: 0, Percentile: inf%\n",
      "Model: 2, Actual: 20, Percentile: 10.0%\n",
      "Model: 2, Actual: 13, Percentile: 15.38%\n",
      "Model: 1, Actual: 5, Percentile: 20.0%\n",
      "Model: 1, Actual: 0, Percentile: inf%\n",
      "Model: 1, Actual: 2, Percentile: 50.0%\n",
      "Model: 1, Actual: 1, Percentile: 100.0%\n",
      "Model: 1, Actual: 4, Percentile: 25.0%\n",
      "Model: 1, Actual: 1, Percentile: 100.0%\n",
      "Model: 1, Actual: 8, Percentile: 12.5%\n",
      "Model: 1, Actual: 1, Percentile: 100.0%\n",
      "Model: 1, Actual: 2, Percentile: 50.0%\n",
      "Model: 1, Actual: 1, Percentile: 100.0%\n",
      "Model: 1, Actual: 1, Percentile: 100.0%\n",
      "Model: 2, Actual: 1, Percentile: 200.0%\n",
      "Model: 2, Actual: 2, Percentile: 100.0%\n",
      "Model: 1, Actual: 1, Percentile: 100.0%\n",
      "Model: 2, Actual: 4, Percentile: 50.0%\n",
      "Model: 1, Actual: 3, Percentile: 33.33%\n",
      "Model: 1, Actual: 1, Percentile: 100.0%\n",
      "Model: 1, Actual: 4, Percentile: 25.0%\n",
      "Model: 1, Actual: 1, Percentile: 100.0%\n",
      "Model: 1, Actual: 1, Percentile: 100.0%\n",
      "Model: 1, Actual: 1, Percentile: 100.0%\n",
      "Model: 2, Actual: 6, Percentile: 33.33%\n",
      "Model: 2, Actual: 6, Percentile: 33.33%\n",
      "Model: 1, Actual: 4, Percentile: 25.0%\n"
     ]
    }
   ],
   "source": [
    "for X, y in zip(X_test[:50], y_test[:50]):\n",
    "    print(f\"Model: {rfc_b.predict([X])[0]}, Actual: {y}, Percentile: {round((rfc_b.predict([X])[0]/y)*100.00, 2)}%\")"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### 6.2.2 Random Forest Regressor"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 48,
   "metadata": {},
   "outputs": [],
   "source": [
    "from sklearn.ensemble import RandomForestRegressor"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 52,
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[Parallel(n_jobs=1)]: Using backend SequentialBackend with 1 concurrent workers.\n",
      "[Parallel(n_jobs=1)]: Done 100 out of 100 | elapsed: 10.3min finished\n",
      "[Parallel(n_jobs=1)]: Using backend SequentialBackend with 1 concurrent workers.\n",
      "[Parallel(n_jobs=1)]: Done 100 out of 100 | elapsed:    5.2s finished\n",
      "[Parallel(n_jobs=1)]: Using backend SequentialBackend with 1 concurrent workers.\n",
      "[Parallel(n_jobs=1)]: Done 100 out of 100 | elapsed:    1.8s finished\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "0.1064278233412217"
      ]
     },
     "execution_count": 52,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "rfc_r = RandomForestRegressor(max_depth=2, random_state=0, n_estimators=100, verbose=True)\n",
    "rfc_r.fit(X_train, y_train)\n",
    "y_pred = rfc_r.predict(X_train)\n",
    "rfc_r.score(X_test, y_test)\n",
    "# print('Train accuracy score:',accuracy_score(y_train,y_pred))\n",
    "# print('Test accuracy score:', accuracy_score(y_test,rfc_b.predict(X_test)))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 55,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Model: 1, Actual: 0, Percentile: inf%\n",
      "Model: 1, Actual: 2, Percentile: 50.0%\n",
      "Model: 1, Actual: 4, Percentile: 25.0%\n",
      "Model: 1, Actual: 3, Percentile: 33.33%\n",
      "Model: 1, Actual: 1, Percentile: 100.0%\n",
      "Model: 1, Actual: 0, Percentile: inf%\n",
      "Model: 1, Actual: 2, Percentile: 50.0%\n",
      "Model: 2, Actual: 3, Percentile: 66.67%\n",
      "Model: 1, Actual: 3, Percentile: 33.33%\n",
      "Model: 1, Actual: 2, Percentile: 50.0%\n",
      "Model: 1, Actual: 2, Percentile: 50.0%\n",
      "Model: 1, Actual: 1, Percentile: 100.0%\n",
      "Model: 1, Actual: 0, Percentile: inf%\n",
      "Model: 2, Actual: 2, Percentile: 100.0%\n",
      "Model: 1, Actual: 1, Percentile: 100.0%\n",
      "Model: 2, Actual: 6, Percentile: 33.33%\n",
      "Model: 1, Actual: 2, Percentile: 50.0%\n",
      "Model: 1, Actual: 0, Percentile: inf%\n",
      "Model: 1, Actual: 0, Percentile: inf%\n",
      "Model: 1, Actual: 2, Percentile: 50.0%\n",
      "Model: 1, Actual: 1, Percentile: 100.0%\n",
      "Model: 1, Actual: 2, Percentile: 50.0%\n",
      "Model: 1, Actual: 1, Percentile: 100.0%\n",
      "Model: 1, Actual: 0, Percentile: inf%\n",
      "Model: 2, Actual: 20, Percentile: 10.0%\n",
      "Model: 2, Actual: 13, Percentile: 15.38%\n",
      "Model: 1, Actual: 5, Percentile: 20.0%\n",
      "Model: 1, Actual: 0, Percentile: inf%\n",
      "Model: 1, Actual: 2, Percentile: 50.0%\n",
      "Model: 1, Actual: 1, Percentile: 100.0%\n",
      "Model: 1, Actual: 4, Percentile: 25.0%\n",
      "Model: 1, Actual: 1, Percentile: 100.0%\n",
      "Model: 1, Actual: 8, Percentile: 12.5%\n",
      "Model: 1, Actual: 1, Percentile: 100.0%\n",
      "Model: 1, Actual: 2, Percentile: 50.0%\n",
      "Model: 1, Actual: 1, Percentile: 100.0%\n",
      "Model: 1, Actual: 1, Percentile: 100.0%\n",
      "Model: 2, Actual: 1, Percentile: 200.0%\n",
      "Model: 2, Actual: 2, Percentile: 100.0%\n",
      "Model: 1, Actual: 1, Percentile: 100.0%\n",
      "Model: 2, Actual: 4, Percentile: 50.0%\n",
      "Model: 1, Actual: 3, Percentile: 33.33%\n",
      "Model: 1, Actual: 1, Percentile: 100.0%\n",
      "Model: 1, Actual: 4, Percentile: 25.0%\n",
      "Model: 1, Actual: 1, Percentile: 100.0%\n",
      "Model: 1, Actual: 1, Percentile: 100.0%\n",
      "Model: 1, Actual: 1, Percentile: 100.0%\n",
      "Model: 2, Actual: 6, Percentile: 33.33%\n",
      "Model: 2, Actual: 6, Percentile: 33.33%\n",
      "Model: 1, Actual: 4, Percentile: 25.0%\n"
     ]
    }
   ],
   "source": [
    "for X, y in zip(X_test[:50], y_test[:50]):\n",
    "    print(f\"Model: {rfc_b.predict([X])[0]}, Actual: {y}, Percentile: {round((rfc_b.predict([X])[0]/y)*100.00, 2)}%\")"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## 6.2.2 Naive Bayes"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 56,
   "metadata": {},
   "outputs": [],
   "source": [
    "from sklearn.naive_bayes import GaussianNB"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 57,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0.34029859919725075"
      ]
     },
     "execution_count": 57,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "gnb = GaussianNB()\n",
    "gnb.fit(X_train, y_train)\n",
    "gnb.score(X_test, y_test)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 58,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Model: 1, Actual: 0, Percentile: inf%\n",
      "Model: 1, Actual: 2, Percentile: 50.0%\n",
      "Model: 1, Actual: 4, Percentile: 25.0%\n",
      "Model: 1, Actual: 3, Percentile: 33.33%\n",
      "Model: 2, Actual: 1, Percentile: 200.0%\n",
      "Model: 1, Actual: 0, Percentile: inf%\n",
      "Model: 1, Actual: 2, Percentile: 50.0%\n",
      "Model: 3, Actual: 3, Percentile: 100.0%\n",
      "Model: 1, Actual: 3, Percentile: 33.33%\n",
      "Model: 1, Actual: 2, Percentile: 50.0%\n",
      "Model: 1, Actual: 2, Percentile: 50.0%\n",
      "Model: 1, Actual: 1, Percentile: 100.0%\n",
      "Model: 1, Actual: 0, Percentile: inf%\n",
      "Model: 2, Actual: 2, Percentile: 100.0%\n",
      "Model: 2, Actual: 1, Percentile: 200.0%\n",
      "Model: 3, Actual: 6, Percentile: 50.0%\n",
      "Model: 1, Actual: 2, Percentile: 50.0%\n",
      "Model: 1, Actual: 0, Percentile: inf%\n",
      "Model: 1, Actual: 0, Percentile: inf%\n",
      "Model: 1, Actual: 2, Percentile: 50.0%\n",
      "Model: 1, Actual: 1, Percentile: 100.0%\n",
      "Model: 1, Actual: 2, Percentile: 50.0%\n",
      "Model: 1, Actual: 1, Percentile: 100.0%\n",
      "Model: 1, Actual: 0, Percentile: inf%\n",
      "Model: 103, Actual: 20, Percentile: 515.0%\n",
      "Model: 2, Actual: 13, Percentile: 15.38%\n",
      "Model: 1, Actual: 5, Percentile: 20.0%\n",
      "Model: 1, Actual: 0, Percentile: inf%\n",
      "Model: 72, Actual: 2, Percentile: 3600.0%\n",
      "Model: 1, Actual: 1, Percentile: 100.0%\n",
      "Model: 61, Actual: 4, Percentile: 1525.0%\n",
      "Model: 1, Actual: 1, Percentile: 100.0%\n",
      "Model: 2, Actual: 8, Percentile: 25.0%\n",
      "Model: 1, Actual: 1, Percentile: 100.0%\n",
      "Model: 2, Actual: 2, Percentile: 100.0%\n",
      "Model: 1, Actual: 1, Percentile: 100.0%\n",
      "Model: 1, Actual: 1, Percentile: 100.0%\n",
      "Model: 2, Actual: 1, Percentile: 200.0%\n",
      "Model: 2, Actual: 2, Percentile: 100.0%\n",
      "Model: 2, Actual: 1, Percentile: 200.0%\n",
      "Model: 2, Actual: 4, Percentile: 50.0%\n",
      "Model: 1, Actual: 3, Percentile: 33.33%\n",
      "Model: 1, Actual: 1, Percentile: 100.0%\n",
      "Model: 1, Actual: 4, Percentile: 25.0%\n",
      "Model: 1, Actual: 1, Percentile: 100.0%\n",
      "Model: 1, Actual: 1, Percentile: 100.0%\n",
      "Model: 1, Actual: 1, Percentile: 100.0%\n",
      "Model: 49, Actual: 6, Percentile: 816.67%\n",
      "Model: 103, Actual: 6, Percentile: 1716.67%\n",
      "Model: 2, Actual: 4, Percentile: 50.0%\n"
     ]
    }
   ],
   "source": [
    "for X, y in zip(X_test[:50], y_test[:50]):\n",
    "    print(f\"Model: {gnb.predict([X])[0]}, Actual: {y}, Percentile: {round((gnb.predict([X])[0]/y)*100.00, 2)}%\")"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## 6.3 Clustering"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### 6.3.1 KMeans"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 59,
   "metadata": {},
   "outputs": [],
   "source": [
    "from sklearn.cluster import KMeans"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 60,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "-1.6745322883750467e+17"
      ]
     },
     "execution_count": 60,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "kmeans = KMeans(n_clusters=4, random_state=0, verbose=0)\n",
    "kmeans.fit(X_train, y_train)\n",
    "kmeans.score(X_test, y_test)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 61,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Model: 1, Actual: 0, Percentile: inf%\n",
      "Model: 1, Actual: 2, Percentile: 50.0%\n",
      "Model: 1, Actual: 4, Percentile: 25.0%\n",
      "Model: 1, Actual: 3, Percentile: 33.33%\n",
      "Model: 3, Actual: 1, Percentile: 300.0%\n",
      "Model: 1, Actual: 0, Percentile: inf%\n",
      "Model: 1, Actual: 2, Percentile: 50.0%\n",
      "Model: 1, Actual: 3, Percentile: 33.33%\n",
      "Model: 1, Actual: 3, Percentile: 33.33%\n",
      "Model: 1, Actual: 2, Percentile: 50.0%\n",
      "Model: 1, Actual: 2, Percentile: 50.0%\n",
      "Model: 1, Actual: 1, Percentile: 100.0%\n",
      "Model: 1, Actual: 0, Percentile: inf%\n",
      "Model: 3, Actual: 2, Percentile: 150.0%\n",
      "Model: 3, Actual: 1, Percentile: 300.0%\n",
      "Model: 1, Actual: 6, Percentile: 16.67%\n",
      "Model: 3, Actual: 2, Percentile: 150.0%\n",
      "Model: 1, Actual: 0, Percentile: inf%\n",
      "Model: 1, Actual: 0, Percentile: inf%\n",
      "Model: 1, Actual: 2, Percentile: 50.0%\n",
      "Model: 1, Actual: 1, Percentile: 100.0%\n",
      "Model: 1, Actual: 2, Percentile: 50.0%\n",
      "Model: 1, Actual: 1, Percentile: 100.0%\n",
      "Model: 1, Actual: 0, Percentile: inf%\n",
      "Model: 2, Actual: 20, Percentile: 10.0%\n",
      "Model: 1, Actual: 13, Percentile: 7.69%\n",
      "Model: 3, Actual: 5, Percentile: 60.0%\n",
      "Model: 1, Actual: 0, Percentile: inf%\n",
      "Model: 0, Actual: 2, Percentile: 0.0%\n",
      "Model: 1, Actual: 1, Percentile: 100.0%\n",
      "Model: 0, Actual: 4, Percentile: 0.0%\n",
      "Model: 1, Actual: 1, Percentile: 100.0%\n",
      "Model: 2, Actual: 8, Percentile: 25.0%\n",
      "Model: 1, Actual: 1, Percentile: 100.0%\n",
      "Model: 2, Actual: 2, Percentile: 100.0%\n",
      "Model: 1, Actual: 1, Percentile: 100.0%\n",
      "Model: 1, Actual: 1, Percentile: 100.0%\n",
      "Model: 1, Actual: 1, Percentile: 100.0%\n",
      "Model: 0, Actual: 2, Percentile: 0.0%\n",
      "Model: 3, Actual: 1, Percentile: 300.0%\n",
      "Model: 1, Actual: 4, Percentile: 25.0%\n",
      "Model: 0, Actual: 3, Percentile: 0.0%\n",
      "Model: 1, Actual: 1, Percentile: 100.0%\n",
      "Model: 1, Actual: 4, Percentile: 25.0%\n",
      "Model: 1, Actual: 1, Percentile: 100.0%\n",
      "Model: 1, Actual: 1, Percentile: 100.0%\n",
      "Model: 1, Actual: 1, Percentile: 100.0%\n",
      "Model: 2, Actual: 6, Percentile: 33.33%\n",
      "Model: 2, Actual: 6, Percentile: 33.33%\n",
      "Model: 3, Actual: 4, Percentile: 75.0%\n"
     ]
    }
   ],
   "source": [
    "for X, y in zip(X_test[:50], y_test[:50]):\n",
    "    print(f\"Model: {kmeans.predict([X])[0]}, Actual: {y}, Percentile: {round((kmeans.predict([X])[0]/y)*100.00, 2)}%\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.7.3"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 4
}
