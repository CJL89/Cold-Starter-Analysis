{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {
    "extensions": {
     "jupyter_dashboards": {
      "version": 1,
      "views": {
       "grid_default": {
        "hidden": true
       },
       "report_default": {}
      }
     }
    }
   },
   "outputs": [],
   "source": [
    "# Importing dependecies:\n",
    "import numpy as np\n",
    "import pandas as pd\n",
    "from tqdm import tqdm\n",
    "import matplotlib.pyplot as plt\n",
    "import seaborn as sns\n",
    "sns.set(style='darkgrid')\n",
    "import os\n",
    "\n",
    "# Configuring Notebook environment:\n",
    "sns.set()\n",
    "%matplotlib inline\n",
    "%config InlineBackend.figure_format = 'svg'\n",
    "\n",
    "plt.rcParams['figure.figsize'] = (10.0, 7.5)\n",
    "pd.set_option('display.max_columns', 100)\n",
    "pd.set_option('display.max_rows', 100)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# 2.0 Data Overview:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {
    "extensions": {
     "jupyter_dashboards": {
      "version": 1,
      "views": {
       "grid_default": {
        "col": 0,
        "height": 9,
        "hidden": false,
        "row": 0,
        "width": 12
       },
       "report_default": {}
      }
     }
    }
   },
   "outputs": [],
   "source": [
    "# Importing documents:\n",
    "df = pd.read_csv('cj_single_view.csv', index_col=0, low_memory=False)\n",
    "df.head()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# 3.0 Data Pre-Processing:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {
    "extensions": {
     "jupyter_dashboards": {
      "version": 1,
      "views": {
       "grid_default": {
        "col": 0,
        "height": 26,
        "hidden": false,
        "row": 9,
        "width": 4
       },
       "report_default": {}
      }
     }
    }
   },
   "outputs": [],
   "source": [
    "print('Dataset headers:', df.columns)\n",
    "\n",
    "# Changing columns names to lower case for uniformity:\n",
    "df.columns = map(str.lower, df.columns)\n",
    "print('Lowercase headers:', df.columns)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {
    "extensions": {
     "jupyter_dashboards": {
      "version": 1,
      "views": {
       "grid_default": {
        "hidden": true
       },
       "report_default": {}
      }
     }
    }
   },
   "outputs": [],
   "source": [
    "df.info()\n",
    "\n",
    "# Changing classification of object types to lower memory usage:\n",
    "df[['display', 'mailer', 'description', 'department', 'brand', 'age_desc', 'marital_status_code', \n",
    "    'income_desc', 'homeowner_desc', 'hh_comp_desc', 'household_size_desc', 'kid_category_desc']] = df[['display', \n",
    "    'mailer', 'description', 'department', 'brand', 'age_desc', 'marital_status_code', \n",
    "    'income_desc', 'homeowner_desc', 'hh_comp_desc', 'household_size_desc', 'kid_category_desc']].astype('category')\n",
    "df[['commodity_desc', 'sub_commodity_desc', 'curr_size_of_product']] = df[['commodity_desc', \n",
    "    'sub_commodity_desc', 'curr_size_of_product']].astype(str)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {
    "extensions": {
     "jupyter_dashboards": {
      "version": 1,
      "views": {
       "grid_default": {
        "col": 4,
        "height": 27,
        "hidden": false,
        "row": 9,
        "width": 4
       },
       "report_default": {}
      }
     }
    }
   },
   "outputs": [],
   "source": [
    "df.info()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {
    "extensions": {
     "jupyter_dashboards": {
      "version": 1,
      "views": {
       "grid_default": {
        "col": 8,
        "height": 24,
        "hidden": false,
        "row": 9,
        "width": 4
       },
       "report_default": {}
      }
     }
    }
   },
   "outputs": [],
   "source": [
    "plt.figure(figsize=(10, 2.5))\n",
    "\n",
    "_ = plt.plot(df.isnull().count())\n",
    "_ = plt.title('Null values:', size=17.5)\n",
    "_ = plt.xticks(rotation=90)\n",
    "_ = plt.yticks(size=8)\n",
    "\n",
    "plt.tight_layout()\n",
    "plt.savefig('graphs/null_values.png')\n",
    "plt.show()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "df.describe()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Creating the cold starters and saving them in their own dataset:\n",
    "cold_starters = df.groupby('household_key').first().reset_index()\n",
    "cold_starters.shape"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "df.to_csv('df_clean.csv', index=False)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# 4.0 Data Analysis:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Analysing which products are purchased most often:\n",
    "idx = df.product_id.value_counts().index\n",
    "product_count = df.product_id.value_counts().values\n",
    "percentage = product_count / (df.shape[0] * 100)\n",
    "\n",
    "plt.figure(figsize=(14, 7))\n",
    "plt.subplot(3, 1, 1)\n",
    "_ = sns.countplot(df.product_id, order=idx[:50])\n",
    "_ = plt.title('Products Popularity:', size=20)\n",
    "_ = plt.xlabel('Product ID', size=15)\n",
    "_ = plt.ylabel('Count', size=15)\n",
    "_ = plt.xticks(rotation=90)\n",
    "\n",
    "plt.subplot(3, 1, 2)\n",
    "_ = sns.countplot(cold_starters.product_id, order=idx[:50])\n",
    "_ = plt.title('Products Popularity relationship with Cold Starters:', size=20)\n",
    "_ = plt.xlabel('Product ID', size=15)\n",
    "_ = plt.ylabel('Count', size=15)\n",
    "_ = plt.xticks(rotation=90)\n",
    "\n",
    "plt.subplot(3, 1, 3)\n",
    "_ = sns.countplot(cold_starters.product_id, order=cold_starters.product_id.value_counts().index[:50])\n",
    "_ = plt.title('Products Popularity for Cold Starters:', size=20)\n",
    "_ = plt.xlabel('Product ID', size=15)\n",
    "_ = plt.ylabel('Count', size=15)\n",
    "_ = plt.xticks(rotation=90)\n",
    "\n",
    "plt.tight_layout()\n",
    "plt.savefig('graphs/product_popularity.png')\n",
    "plt.show()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "popular_product = df[df['product_id'] == 995242]\n",
    "cold_starters_product = cold_starters[cold_starters['product_id'] == 819518]\n",
    "\n",
    "plt.figure(figsize=(14, 5))\n",
    "\n",
    "plt.subplot(2, 1, 1)\n",
    "_ = sns.countplot(popular_product['store_id'], order=popular_product.store_id.value_counts().index[:50])\n",
    "_ = sns.countplot(cold_starters['store_id'], order=popular_product.store_id.value_counts().index[:50], palette='rocket')\n",
    "_ = plt.title('Popularity of most popular product (995242) by store_id:', size=20)\n",
    "_ = plt.xlabel('Store ID', size=15)\n",
    "_ = plt.ylabel('Total Count', size=15)\n",
    "_ = plt.xticks(rotation=90)\n",
    "\n",
    "plt.subplot(2, 1, 2)\n",
    "_ = sns.countplot(cold_starters_product['store_id'], order=cold_starters_product.store_id.value_counts().index[:50])\n",
    "_ = plt.title('Popularity amongst cold startes of most popular product (819518) by store_id:', size=20)\n",
    "_ = plt.xlabel('Store ID', size=15)\n",
    "_ = plt.ylabel('Total Count', size=15)\n",
    "_ = plt.xticks(rotation=90)\n",
    "\n",
    "plt.tight_layout()\n",
    "plt.savefig('graphs/most_popular_product.png')\n",
    "plt.show()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "plt.figure(figsize=(14, 5))\n",
    "\n",
    "plt.subplot(2, 1, 1)\n",
    "_ = sns.countplot(df['store_id'], order=df['store_id'].value_counts().index[:50])\n",
    "_ = plt.title('Store with most transactions:', size=20)\n",
    "_ = plt.xlabel('')\n",
    "_ = plt.ylabel('')\n",
    "_ = plt.xticks(rotation=90)\n",
    "\n",
    "plt.subplot(2, 1, 2)\n",
    "_ = sns.countplot(cold_starters['store_id'], order=cold_starters['store_id'].value_counts().index[:50])\n",
    "_ = plt.title(\"Cold starter's store with most transactions:\", size=20)\n",
    "_ = plt.xlabel('Store ID', size=15)\n",
    "_ = plt.ylabel('Total Count', size=15)\n",
    "_ = plt.xticks(rotation=90)\n",
    "\n",
    "plt.tight_layout()\n",
    "plt.savefig('graphs/transactions.png')\n",
    "plt.show()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "plt.figure(figsize=(15, 5))\n",
    "\n",
    "plt.subplot(2, 1, 1)\n",
    "_ = sns.countplot(df.week_no)\n",
    "_ = plt.title('Week distribution:', size=20)\n",
    "_ = plt.xlabel('')\n",
    "_ = plt.ylabel('')\n",
    "_ = plt.xticks(rotation=90, size=9)\n",
    "\n",
    "plt.subplot(2, 1, 2)\n",
    "_ = sns.countplot(cold_starters.week_no)\n",
    "_ = plt.title('Cold starters week distribution:', size=20)\n",
    "_ = plt.xlabel('Store ID', size=15)\n",
    "_ = plt.ylabel('Total Count', size=15)\n",
    "_ = plt.xticks(rotation=90, size=9)\n",
    "\n",
    "plt.tight_layout()\n",
    "plt.savefig('graphs/week_distribution.png')\n",
    "plt.show()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {
    "extensions": {
     "jupyter_dashboards": {
      "version": 1,
      "views": {
       "grid_default": {
        "col": 8,
        "height": 4,
        "hidden": false,
        "row": 33,
        "width": 4
       },
       "report_default": {}
      }
     }
    }
   },
   "outputs": [],
   "source": [
    "# Analysing relationship between age and income:\n",
    "sorted_income = ['Under 15K', '15-24K', '25-34K', '35-49K', '50-74K', '75-99K', '100-124K', '125-149K', '150-174K', '175-199K', '200-249K', '250K+']\n",
    "\n",
    "plt.figure(figsize=(15, 7.5))\n",
    "\n",
    "plt.subplot(2, 1, 1)\n",
    "_ = sns.countplot(x='income_desc', data=df, hue='age_desc', order=sorted_income)\n",
    "_ = plt.title('Relationship between age and income:', size=20)\n",
    "_ = plt.xlabel('')\n",
    "_ = plt.ylabel('')\n",
    "_ = plt.xticks(rotation=80)\n",
    "_ = plt.legend(loc='upper right')\n",
    "\n",
    "plt.subplot(2, 1, 2)\n",
    "_ = sns.countplot(x='income_desc', data=cold_starters, hue='age_desc', order=sorted_income)\n",
    "_ = plt.title('Cold starters relationship between age and income:', size=20)\n",
    "_ = plt.xlabel('Income Groups')\n",
    "_ = plt.ylabel('Total Amount')\n",
    "_ = plt.xticks(rotation=80)\n",
    "_ = plt.legend(loc='upper right')\n",
    "\n",
    "plt.tight_layout()\n",
    "plt.savefig('graphs/age_income.png')\n",
    "plt.show()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "plt.figure(figsize=(14, 7.5))\n",
    "\n",
    "plt.subplot(2, 1, 1)\n",
    "ax = sns.countplot(df['income_desc'], order=sorted_income)\n",
    "_ = plt.title('Distribution of coupons used based on income range:', size=20)\n",
    "_ = plt.xlabel('Income Ranges')\n",
    "_ = plt.ylabel('Total Amount')\n",
    "_ = plt.xticks(rotation=75)\n",
    "\n",
    "# https://stackoverflow.com/questions/33179122/seaborn-countplot-with-frequencies/33259038\n",
    "for p in ax.patches:\n",
    "    x = p.get_bbox().get_points()[:,0]\n",
    "    y = p.get_bbox().get_points()[1,1]\n",
    "    ax.annotate('{:.1f}%'.format(100. * y / len(df)), (x.mean(), y), ha='center', va='bottom') # set the alignment of the text\n",
    "\n",
    "plt.subplot(2, 1, 2)\n",
    "ax = sns.countplot(cold_starters['income_desc'], order=sorted_income)\n",
    "_ = plt.title('Cold starter distribution of coupons used based on income range:', size=20)\n",
    "_ = plt.xlabel('Income Ranges')\n",
    "_ = plt.ylabel('Total Amount')\n",
    "_ = plt.xticks(rotation=75)\n",
    "\n",
    "for p in ax.patches:\n",
    "    x = p.get_bbox().get_points()[:,0]\n",
    "    y = p.get_bbox().get_points()[1,1]\n",
    "    ax.annotate('{:.1f}%'.format(100. * y / len(cold_starters)), (x.mean(), y), ha='center', va='bottom') # set the alignment of the text\n",
    "    \n",
    "plt.tight_layout()\n",
    "plt.savefig('graphs/income_distribution.png')\n",
    "plt.show()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Comparing which age group uses more coupons:\n",
    "df_19_24 = pd.DataFrame(df[df['age_desc'] == '19-24'])\n",
    "df_25_34 = pd.DataFrame(df[df['age_desc'] == '25-34'])\n",
    "df_35_44 = pd.DataFrame(df[df['age_desc'] == '35-44'])\n",
    "df_45_54 = pd.DataFrame(df[df['age_desc'] == '45-54'])\n",
    "df_55_65 = pd.DataFrame(df[df['age_desc'] == '55-64'])\n",
    "df_65_plus = pd.DataFrame(df[df['age_desc'] == '65+'])\n",
    "\n",
    "plt.figure(figsize=(10, 15))\n",
    "\n",
    "plt.subplot(6, 1, 1)\n",
    "_ = sns.countplot(df_19_24['income_desc'], order=sorted_income)\n",
    "_ = plt.title('Age Range Between 19-24:', size=15)\n",
    "_ = plt.xlabel('Income Ranges')\n",
    "_ = plt.ylabel('Total Amount')\n",
    "_ = plt.xticks(rotation=75)\n",
    "\n",
    "plt.subplot(6, 1, 2)\n",
    "_ = sns.countplot(df_25_34['income_desc'], order=sorted_income)\n",
    "_ = plt.title('Age Range Between 25-34:', size=15)\n",
    "_ = plt.xlabel('')\n",
    "_ = plt.ylabel('')\n",
    "_ = plt.xticks(rotation=75)\n",
    "\n",
    "plt.subplot(6, 1, 3)\n",
    "_ = sns.countplot(df_35_44['income_desc'], order=sorted_income)\n",
    "_ = plt.title('Age Range Between 35-44:', size=15)\n",
    "_ = plt.xlabel('')\n",
    "_ = plt.ylabel('')\n",
    "_ = plt.xticks(rotation=75)\n",
    "\n",
    "plt.subplot(6, 1, 4)\n",
    "_ = sns.countplot(df_45_54['income_desc'], order=sorted_income)\n",
    "_ = plt.title('Age Range Between 45-54:', size=15)\n",
    "_ = plt.xlabel('')\n",
    "_ = plt.ylabel('')\n",
    "_ = plt.xticks(rotation=75)\n",
    "\n",
    "plt.subplot(6, 1, 5)\n",
    "_ = sns.countplot(df_55_65['income_desc'], order=sorted_income)\n",
    "_ = plt.title('Age Range Between 55-64:', size=15)\n",
    "_ = plt.xlabel('')\n",
    "_ = plt.ylabel('')\n",
    "_ = plt.xticks(rotation=75)\n",
    "\n",
    "plt.subplot(6, 1, 6)\n",
    "_ = sns.countplot(df_65_plus['income_desc'], order=sorted_income)\n",
    "_ = plt.title('Age Range Between 65+:', size=15)\n",
    "_ = plt.xlabel('Income Ranges')\n",
    "_ = plt.ylabel('Total Amount')\n",
    "_ = plt.xticks(rotation=75)\n",
    "\n",
    "plt.tight_layout()\n",
    "plt.savefig('graphs/age_distributions.png')\n",
    "plt.show()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# 5.0 Correlation of columns:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "plt.figure(figsize=(15, 15))\n",
    "\n",
    "plt.subplot(2, 1, 1)\n",
    "corr = df.corr()\n",
    "_ = sns.heatmap(corr, annot=True)\n",
    "_ = plt.title('Correlation of columns:', size=20)\n",
    "\n",
    "plt.subplot(2, 1, 2)\n",
    "corr = cold_starters.corr()\n",
    "_ = sns.heatmap(corr, annot=True)\n",
    "_ = plt.title('Cold starters correlation:', size=20)\n",
    "\n",
    "plt.tight_layout()\n",
    "plt.savefig('graphs/correlations.png')\n",
    "plt.show()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "plt.figure(figsize=(10, 7.5))\n",
    "\n",
    "plt.subplot(3, 1, 1)\n",
    "_ = sns.distplot(df.sales_value, bins=100, kde=False)\n",
    "_ = plt.title('Distribution of sales:', size=20)\n",
    "_ = plt.xlabel('Sales', size=12)\n",
    "_ = plt.ylabel('Total count', size=12)\n",
    "\n",
    "plt.subplot(3, 1, 2)\n",
    "_ = sns.distplot(df.product_id, kde=False)\n",
    "_ = plt.title('Distribution of products:', size=20)\n",
    "_ = plt.xlabel('Product ID', size=12)\n",
    "\n",
    "plt.subplot(3, 1, 3)\n",
    "_ = sns.distplot(df.manufacturer, kde=False)\n",
    "_ = plt.title('Distribution of manufacturer:', size=20)\n",
    "_ = plt.xlabel('Manufacturer', size=12)\n",
    "_ = plt.ylabel('Total count', size=12)\n",
    "\n",
    "plt.tight_layout()\n",
    "plt.savefig('graphs/product_distribution.png')\n",
    "plt.show()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# 6.0 Machine Learning Processing:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "import sklearn\n",
    "from sklearn.model_selection import train_test_split\n",
    "from sklearn.linear_model import LinearRegression\n",
    "from sklearn import preprocessing"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## 6.1.0 Linear Regression"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### 6.1.1 Linear Regression - To predict product prices"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "df_clean = pd.read_csv('df_clean.csv')\n",
    "df_clean.columns"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "cols = ['mailer', 'brand', 'commodity_desc']\n",
    "for name in cols:\n",
    "    print(name,':')\n",
    "    print(df_clean[name].value_counts(),'\\n')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "df_clean['brand'] = df_clean['brand'].astype('category').cat.codes\n",
    "df_clean['mailer'] = df_clean['mailer'].astype('category').cat.codes\n",
    "df_clean['commodity_desc'] = df_clean['commodity_desc'].astype('category').cat.codes"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Calculating a simple linear regression, even though it is not the most effective way to train the dataset on:\n",
    "X = df_clean[['product_id', 'manufacturer', 'retail_disc', 'coupon_match_disc', 'commodity_desc', 'brand', 'mailer']].values\n",
    "y = df_clean['sales_value'].values\n",
    "X"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "X = preprocessing.scale(X)\n",
    "X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.25, random_state=0)\n",
    "\n",
    "X_train.shape, y_train.shape"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "clf = LinearRegression()\n",
    "clf.fit(X_train, y_train)\n",
    "clf.score(X_test, y_test)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "for X, y in zip(X_test[:100], y_test[:100]):\n",
    "    print(f\"Model: {clf.predict([X])[0]}, Actual: {y}\")"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "<!-- ### 6.2 SVM -->"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "# from sklearn import svm"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {},
   "outputs": [],
   "source": [
    "# clf = svm.SVR(kernel='linear', verbose=True)\n",
    "# clf.fit(X_train, y_train)\n",
    "# clf.score(X_Test, y_test)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {},
   "outputs": [],
   "source": [
    "# for X, y in zip(X_test[:100], y_test[:100]):\n",
    "#     print(f\"Model: {clf.predict([X])[0]}, Actual: {y}\")"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## 6.2 Clustering"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### 6.2.1 KMeans"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "from sklearn.cluster import KMeans"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "kmeans = KMeans(n_clusters=4, random_state=0, verbose=0)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "kmeans.fit(X_train)\n",
    "kmeans.cluster_centers_\n",
    "kmeans.labels_"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "# kmeans.predict(X_test)\n",
    "plt.scatter(X_test[ : , 0], X_test[ : , 1], s =50, c='b')\n",
    "plt.scatter(-0.94665068, -0.97138368, s=200, c='g', marker='s')\n",
    "plt.scatter(2.01559419, 2.02597093, s=200, c='r', marker='s')\n",
    "\n",
    "plt.savefig('graphs/kmeans_plot.png')\n",
    "plt.show()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### 6.2.2 Spectral Clustering"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### 6.2.3 GMM"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "extensions": {
   "jupyter_dashboards": {
    "activeView": "grid_default",
    "version": 1,
    "views": {
     "grid_default": {
      "cellMargin": 10,
      "defaultCellHeight": 20,
      "maxColumns": 12,
      "name": "grid",
      "type": "grid"
     },
     "report_default": {
      "name": "report",
      "type": "report"
     }
    }
   }
  },
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.7.3"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 4
}
